# 多租户校园新生报到系统 API 文档

## 系统概述

本系统是一个基于FastAPI开发的多租户校园新生报到系统，采用现代化的技术栈和架构设计，提供完整的API接口支持。

### 技术栈

- 后端框架：FastAPI
- 数据库：PostgreSQL
- ORM：SQLAlchemy
- 认证：JWT
- 日志：自定义日志系统

### 系统特点

1. 多租户架构
   - 每个租户独立的数据空间
   - 租户级别的权限控制
   - 租户级别的资源隔离

2. 认证与授权
   - JWT token认证
   - 基于角色的权限控制
   - 细粒度的API权限管理

3. 完整的日志系统
   - 访问日志
   - 审计日志
   - 操作日志

4. RESTful API设计
   - 标准的HTTP方法
   - 统一的响应格式
   - 清晰的错误处理

## API文档目录

### 基础接口

- [基础接口文档](base.md)
  - 登录认证
  - 用户信息
  - 菜单权限
  - API权限
  - 密码管理

### 用户管理

- [用户管理接口文档](user.md)
  - 用户创建
  - 用户列表
  - 用户详情
  - 用户更新
  - 用户删除

### 租户管理

- [租户管理接口文档](tenant.md)
  - 租户创建
  - 租户列表
  - 租户详情
  - 租户更新
  - 租户删除

### 角色管理

- [角色管理接口文档](role.md)
  - 角色创建
  - 角色列表
  - 角色详情
  - 角色更新
  - 角色删除

### 菜单管理

- [菜单管理接口文档](menu.md)
  - 菜单创建
  - 菜单列表
  - 菜单详情
  - 菜单更新
  - 菜单删除

### 日志管理

- [日志管理接口文档](log.md)
  - 审计日志
  - 访问日志

## 认证与授权

### JWT认证

系统使用JWT（JSON Web Token）进行用户认证，token包含以下信息：

```json
{
    "sub": "用户ID",
    "exp": "过期时间",
    "type": "token类型",
    "tenant_id": "租户ID"
}
```

### 权限级别

1. 超级管理员
   - 可以管理所有租户
   - 可以管理所有用户
   - 可以管理所有角色
   - 可以管理所有菜单

2. 租户管理员
   - 只能管理自己的租户
   - 可以管理租户内的用户
   - 可以管理租户内的角色
   - 可以管理租户内的菜单

3. 普通用户
   - 只能访问被授权的资源
   - 只能执行被授权的操作

## 错误处理

### HTTP状态码

- 200: 请求成功
- 400: 请求参数错误
- 401: 未认证
- 403: 无权限
- 404: 资源不存在
- 500: 服务器错误

### 错误响应格式

```json
{
    "code": "integer",
    "message": "string",
    "detail": "string"  // 可选
}
```

## 数据模型

系统主要包含以下数据模型：

1. User（用户）
2. Tenant（租户）
3. Role（角色）
4. Menu（菜单）
5. AccessLog（访问日志）
6. AuditLog（审计日志）

详细的数据模型说明请参考[数据模型文档](models.md)。

## 开发指南

### 环境要求

- Python 3.8+
- PostgreSQL 12+
- Redis 6+（可选，用于缓存）

### 快速开始

1. 克隆代码库
2. 安装依赖
3. 配置环境变量
4. 初始化数据库
5. 启动服务

详细说明请参考[开发指南](development.md)。 